{% load static %}
<div x-data="{
        activeItem: null,
        animatePulse: {
            '@keyframes pulseSlight': 'from { transform: scale(1); } to { transform: scale(1.05); }' 
        },
        init() {
            // Add any animations needed for sidebar elements
            const style = document.createElement('style');
            style.textContent = `
                @keyframes pulseSlight { ${this.animatePulse['@keyframes pulseSlight']} }
                .animate-pulse-subtle {
                    animation: pulseSlight 1s ease-in-out infinite alternate;
                }
            `;
            document.head.appendChild(style);
        }
     }"
     class="flex flex-col justify-between items-center h-full py-4 w-full select-none">
   <!-- Logo -->
   <div class="mb-6">
      <a href="{% url 'home:index' %}" hx-boost="true" hx-select="#main-content-inner" hx-target="#main-content" hx-indicator="#loading-indicator" class="block transition-transform duration-300 hover:scale-110">
         <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-10 h-10">
            <!-- Circle background -->
            <circle cx="12" cy="12" r="11" fill="#F5F2E8" stroke="#355E3B" stroke-width="0.5" />
            <!-- N for Nexus -->
            <path d="M8 7.5L8 16.5M8 7.5L12 16.5M12 7.5L12 16.5" stroke="#355E3B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
            <!-- L for LMD -->
            <path d="M14 7.5L14 16.5L17 16.5" stroke="#77AB59" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
            <!-- Connection dots representing a nexus -->
            <circle cx="8" cy="7.5" r="1" fill="#D4E157" />
            <circle cx="12" cy="7.5" r="1" fill="#D4E157" />
            <circle cx="14" cy="7.5" r="1" fill="#D4E157" />
            <circle cx="8" cy="16.5" r="1" fill="#D4E157" />
            <circle cx="12" cy="16.5" r="1" fill="#D4E157" />
            <circle cx="17" cy="16.5" r="1" fill="#D4E157" />
         </svg>
      </a>
   </div>

   <!-- Sidebar Menu -->
   <nav class="flex flex-col items-center w-full space-y-3">
      <a href="{% url 'news:index' %}" 
         @mouseenter="activeItem = 'news'" 
         @mouseleave="activeItem = null"
         hx-boost="true" 
         hx-select="#main-content-inner" 
         hx-target="#main-content" 
         hx-indicator="#loading-indicator" 
         class="flex flex-col items-center text-soft-green-bright hover:text-lime-yellow group transition-all duration-300 relative">
         <div class="relative z-10 p-2 rounded-full group-hover:bg-lime-yellow/20 transition-colors duration-300">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform group-hover:scale-110 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
               <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
            </svg>
         </div>
         <span class="text-[10px] mt-1 font-normal transform group-hover:translate-y-0.5 transition-transform duration-300">News</span>
         <div class="absolute left-0 top-0 h-full w-0 bg-lime-yellow/20 group-hover:w-full transition-all duration-300 ease-out rounded-r-md origin-left -z-10"
              :class="activeItem === 'news' && 'w-full'"></div>
      </a>
      <a href="{% url 'chat:index' %}" 
         @mouseenter="activeItem = 'chat'" 
         @mouseleave="activeItem = null"
         hx-boost="true" 
         hx-select="#main-content-inner" 
         hx-target="#main-content" 
         hx-indicator="#loading-indicator" 
         class="flex flex-col items-center text-soft-green-bright hover:text-lime-yellow group transition-all duration-300 relative">
         <div class="relative z-10 p-2 rounded-full group-hover:bg-lime-yellow/20 transition-colors duration-300">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform group-hover:scale-110 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
               <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
            </svg>
         </div>
         <span class="text-[10px] mt-1 font-normal transform group-hover:translate-y-0.5 transition-transform duration-300">Chat</span>
         <div class="absolute left-0 top-0 h-full w-0 bg-lime-yellow/20 group-hover:w-full transition-all duration-300 ease-out rounded-r-md origin-left -z-10"
              :class="activeItem === 'chat' && 'w-full'"></div>
      </a>
      <a href="{% url 'metrics:index' %}" 
         @mouseenter="activeItem = 'metrics'" 
         @mouseleave="activeItem = null"
         hx-boost="true" 
         hx-select="#main-content-inner" 
         hx-target="#main-content" 
         hx-indicator="#loading-indicator" 
         class="flex flex-col items-center text-soft-green-bright hover:text-lime-yellow group transition-all duration-300 relative">
         <div class="relative z-10 p-2 rounded-full group-hover:bg-lime-yellow/20 transition-colors duration-300">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform group-hover:scale-110 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
               <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
            </svg>
         </div>
         <span class="text-[10px] mt-1 font-normal transform group-hover:translate-y-0.5 transition-transform duration-300">Metrics</span>
         <div class="absolute left-0 top-0 h-full w-0 bg-lime-yellow/20 group-hover:w-full transition-all duration-300 ease-out rounded-r-md origin-left -z-10"
              :class="activeItem === 'metrics' && 'w-full'"></div>
      </a>
      <a href="{% url 'production:index' %}" 
         @mouseenter="activeItem = 'production'" 
         @mouseleave="activeItem = null"
         hx-boost="true" 
         hx-select="#main-content-inner" 
         hx-target="#main-content" 
         hx-indicator="#loading-indicator" 
         class="flex flex-col items-center text-soft-green-bright hover:text-lime-yellow group transition-all duration-300 relative">
         <div class="relative z-10 p-2 rounded-full group-hover:bg-lime-yellow/20 transition-colors duration-300">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform group-hover:scale-110 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
               <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" />
            </svg>
         </div>
         <span class="text-[10px] mt-1 font-normal transform group-hover:translate-y-0.5 transition-transform duration-300">Production</span>
         <div class="absolute left-0 top-0 h-full w-0 bg-lime-yellow/20 group-hover:w-full transition-all duration-300 ease-out rounded-r-md origin-left -z-10"
              :class="activeItem === 'production' && 'w-full'"></div>
      </a>
      <a href="{% url 'contact:index' %}" 
         @mouseenter="activeItem = 'contact'" 
         @mouseleave="activeItem = null"
         hx-boost="true" 
         hx-select="#main-content-inner" 
         hx-target="#main-content" 
         hx-indicator="#loading-indicator" 
         class="flex flex-col items-center text-soft-green-bright hover:text-lime-yellow group transition-all duration-300 relative">
         <div class="relative z-10 p-2 rounded-full group-hover:bg-lime-yellow/20 transition-colors duration-300">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform group-hover:scale-110 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
               <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
         </div>
         <span class="text-[10px] mt-1 font-normal transform group-hover:translate-y-0.5 transition-transform duration-300">Contact</span>
         <div class="absolute left-0 top-0 h-full w-0 bg-lime-yellow/20 group-hover:w-full transition-all duration-300 ease-out rounded-r-md origin-left -z-10"
              :class="activeItem === 'contact' && 'w-full'"></div>
      </a>
      <a href="{% url 'about:index' %}" 
         @mouseenter="activeItem = 'about'" 
         @mouseleave="activeItem = null"
         hx-boost="true" 
         hx-select="#main-content-inner" 
         hx-target="#main-content" 
         hx-indicator="#loading-indicator" 
         class="flex flex-col items-center text-soft-green-bright hover:text-lime-yellow group transition-all duration-300 relative">
         <div class="relative z-10 p-2 rounded-full group-hover:bg-lime-yellow/20 transition-colors duration-300">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform group-hover:scale-110 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
               <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
         </div>
         <span class="text-[10px] mt-1 font-normal transform group-hover:translate-y-0.5 transition-transform duration-300">About</span>
         <div class="absolute left-0 top-0 h-full w-0 bg-lime-yellow/20 group-hover:w-full transition-all duration-300 ease-out rounded-r-md origin-left -z-10"
              :class="activeItem === 'about' && 'w-full'"></div>
      </a>
   </nav>

   <!-- User Button with Avatar -->
   <div class="mt-auto pt-4">
      <a href="{% url 'home:index' %}" 
         @mouseenter="activeItem = 'user'" 
         @mouseleave="activeItem = null"
         hx-boost="true" 
         hx-select="#main-content-inner" 
         hx-target="#main-content" 
         hx-indicator="#loading-indicator" 
         class="flex flex-col items-center text-soft-green-bright hover:text-lime-yellow group transition-all duration-300">
         <div class="relative transform group-hover:scale-110 transition-all duration-300" :class="activeItem === 'user' && 'scale-110'">
            {% if user.is_authenticated %}
               {% if user.profile.avatar %}
                  <img src="{{ user.profile.avatar.url }}" alt="User Avatar" class="w-8 h-8 rounded-full object-cover border-2 border-soft-green/30 group-hover:border-lime-yellow/80 transition-colors duration-300">
               {% else %}
                  <div class="w-8 h-8 rounded-full bg-light-beige flex items-center justify-center border-2 border-soft-green/30 group-hover:border-lime-yellow/80 transition-colors duration-300">
                     <span class="text-soft-green/70 text-xs font-medium group-hover:text-soft-green-dark transition-colors duration-300">{{ user.username|slice:":2"|upper }}</span>
                  </div>
               {% endif %}
               <div class="absolute -bottom-1 -right-1 w-3 h-3 bg-lime-yellow rounded-full border border-cream-white group-hover:animate-pulse-subtle"></div>
            {% else %}
               <div class="w-8 h-8 rounded-full bg-light-beige flex items-center justify-center border-2 border-soft-green/30 group-hover:border-lime-yellow/80 transition-colors duration-300">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                     <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                  </svg>
               </div>
            {% endif %}
         </div>
         <span class="text-[10px] mt-1 font-normal transform group-hover:translate-y-0.5 transition-transform duration-300"
               :class="activeItem === 'user' && 'translate-y-0.5'">
            {% if user.is_authenticated %}
               {{ user.username|truncatechars:10 }}
            {% else %}
               Sign In
            {% endif %}
         </span>
      </a>
   </div>
</div>